
<div class="inner-page">
    <div id="follow">
        <a href="//www.instagram.com/birdnerdscanada/" class="insta">Instagram</a>
        <a href="//facebook.com/birdnerdsca/" class="fb">Facebook</a>
        <a href="//twitter.com/bird_nerds/" class="twitter">Twitter</a>
        <a href="mailto:info@birdnerds.ca" class="mail">Mail</a>
    </div>
</div>


<footer class="site-footer">
    <div class="inner-page">
        <div id="garnish">
            <span class="w01"> </span><span class="w02"> </span><span class="w03"> </span><span class="w04"> </span><span class="w05"> </span> </span><span class="w06"> </span>
            <span class="w07"> </span><span class="w08"> </span><span class="w09"> </span><span class="w10"> </span>
        </div>
        <p>&copy; Vince & Sandra 2017</p>
    </div>
</footer>

<script type="text/javascript">

    // -> hamburger nav

    var menuButton = document.getElementById("link-menu");
    if(menuButton) {
        menuButton.onclick = toggleMenu;
    }

    function toggleMenu(event) {
        var el = event.target;
        if ( -1 !== el.className.indexOf( "active" ) ) {
            el.className = el.className.replace( " active", "" );
        } else {
            el.className += " active"
        }
        event.preventDefault();
    }


    // -> pagination

    var showAllButton = document.getElementById("link-show-all");
    if(showAllButton) {
        showAllButton.onclick = showAll;
    }

    function showAll(event) {
        var showAllButton = document.getElementById("link-show-all");
        if(showAllButton) {
            var lazy = document.getElementsByClassName("lazy");
            for(var i=0; i<lazy.length; i++){
                lazy[i].src = lazy[i].getAttribute("data-src");
            }
            showAllButton.classList.add("active");
            if(event) {
                event.preventDefault();
            }
        }

    }


    // -> liteboxes

    var liteboxLinks = document.querySelectorAll(".link-litebox");
    for (var i=0; i < liteboxLinks.length; i++) {
        liteboxLinks[i].addEventListener("click", showLitebox);
    }

    var prevNextLinks = document.querySelectorAll(".prev-link, .next-link");
    for (var i=0; i < prevNextLinks.length; i++) {
        prevNextLinks[i].addEventListener("click", switchLitebox);
    }

    function showLitebox(event) {
        if(event) {
            event.preventDefault();
            if (window.history && window.history.pushState) {
                var loc = window.location.href;
                window.history.pushState(loc, null, "#photographs");
            }
        }
        var id = this.getAttribute("href").replace("#", "");
        var litebox = document.getElementById(id);
        var lazy = litebox.querySelector(".lazy");
        lazy.src = lazy.getAttribute("data-src");
        document.body.style.top = "-" + window.scrollY + "px";
        document.body.style.position = "fixed"
        document.body.classList.add("litebox-open");
        litebox.classList.add("active");
    }

    function switchLitebox(event) {
        if(event) {
            event.preventDefault();
        }
        var id = this.getAttribute("href").replace("#", "");
        var litebox = document.getElementById(id);
        var lazy = litebox.querySelector(".lazy");
        lazy.src = lazy.getAttribute("data-src");
        hideAllLiteboxes();
        litebox.classList.add("active");
    }

    function hideAllLiteboxes(event) {
        if(event) {
            event.preventDefault();
            const scrollY = document.body.style.top;
            document.body.style.position = "";
            document.body.style.top = '';
            document.body.classList.remove("litebox-open");
            window.scrollTo(0, parseInt(scrollY || '0') * -1);
            const loc = window.location;
            // history.pushState("", document.title, loc.pathname + loc.search);
        }
        var openLitebox = document.querySelectorAll(".container-litebox.active");
        for (var i=0; i < openLitebox.length; i++) {
            openLitebox[i].classList.remove("active");
        }
    }

    function positionPrevNext() {
        var w = document.querySelector(".container-pull-right").offsetWidth - 21;
        var h = document.querySelector(".container-pull-right").offsetHeight - 42;
        var prevNext = document.querySelectorAll(".prev-link, .next-link");
        if(w / h < 1.5) {
            var top = (w * (2 / 3 )) / 2;
            for(var i=0; i < prevNext.length; i++) {
                prevNext[i].style.top =  top + 10.5 + 'px';
            }
        }
    }

    document.addEventListener("keyup", function (event) {
        if ( event.key == "Escape" )   {
            hideAllLiteboxes(event);
        }
    });

    window.addEventListener('popstate', function(event) {
        hideAllLiteboxes(event);
    });

    var hasLitebox = document.querySelector(".container-litebox");
    if(hasLitebox) {
        positionPrevNext();
        window.addEventListener("resize", positionPrevNext);
    }


    // -> tab

    var tabs = document.querySelectorAll("#locations-article .tab");
    for (var i=0; i < tabs.length; i++) {
        tabs[i].addEventListener("click", showTab);
    }

    function showTab(event) {
        var parent = document.getElementById("locations-article");
        var spot = this.getAttribute("data-spot");
        parent.classList.remove("calgary-spot");
        parent.classList.remove("alberta-spot");
        parent.classList.add(spot);
        var tabs = document.querySelectorAll("#locations-article .tab");
        for (var i=0; i < tabs.length; i++) {
            tabs[i].classList.remove("active");
        }
        this.classList.add("active");
    }


    // -> virtual birding

    var decorations = document.querySelectorAll(".decoration img");
    for(var i=0; i<decorations.length; i++) {
        decorations[i].addEventListener("click", birdFound);
    }

    function birdFound(event) {
        var birdList = window.sessionStorage.getItem("birdList");
        birdList = birdList ? birdList : "";
        var bird = this.parentElement.classList[1];
        if(birdList.indexOf(bird) < 0) {
            birdList = birdList ? birdList.split(",") : [];
            birdList.push(bird);
            window.sessionStorage.setItem("birdList", birdList.join(","));

        }
        var button = document.querySelector(".button.virtual-birding");
        if(button) {
            button.classList.add("active");
            button.classList.add("updated");
            setTimeout(function() { button.classList.remove("updated")}, 3500);
        }
        if(event) {
            event.preventDefault();
            event.stopPropagation();
        }
    }



    
// -> Bird search

var criteria = document.getElementById("bird-search-criteria");
var searchButton = document.getElementById("bird-search");

function isHidden(el) {
    var style = window.getComputedStyle(el);
    return style.display === 'none';
}

if(criteria && searchButton) {
    criteria.addEventListener("input", function(e) {
        let filter = e.target.value.toString().toLowerCase();
        filter = filter.replace(/(~|!|@|#|$|%|^|&|\*|\(|\)|{|}|\[|\]|;|:|<|,|\.|>|\?|\/|\\|\||-|_|\+|=)/g," ")
        filter = filter.replace(/(`|\"|')/g,"").trim();
        let css = filter ? '#bird-search-results .thumbnail { display: none; } #bird-search-results .thumbnail[data-tags*="' + filter + '" i] {display: block;}'  : '';
        if(!filter.length) {
            window.birdSearchFilter.innerHTML = css;
            let resultsList = document.getElementById("bird-search-results")
            if( filter.length ) {
                resultsList.classList.add("active");
            } else {
                resultsList.classList.remove("active");
                var resultHeading = document.querySelector("#bird-search-results h2");
                resultHeading.setAttribute("data-count", 0);
            }
        }
    });

    searchButton.addEventListener("click", function(e) {
        e.preventDefault();
        let filter = criteria.value.toString().toLowerCase();
        filter = filter.replace(/(~|!|@|#|$|%|^|&|\*|\(|\)|{|}|\[|\]|;|:|<|,|\.|>|\?|\/|\\|\||-|_|\+|=)/g," ")
        filter = filter.replace(/(`|\"|')/g,"").trim();
        let css = filter ? '#bird-search-results .thumbnail { display: none; } #bird-search-results .thumbnail[data-tags*="' + filter + '"] {display: block;}' : '';
        if(filter.length) {
            window.birdSearchFilter.innerHTML = css;
            let resultList = document.getElementById("bird-search-results")
            if( filter.length ) {
                resultList.classList.add("active");
            } else {
                resultList.classList.remove("active");
            }
        }
        var thumbs = document.querySelectorAll("#bird-search-results .thumbnail");
        var resultCount = 0;
        for(var i=0; i<thumbs.length; i++){
            if(!isHidden(thumbs[i])) {
                resultCount += 1;
                var lazy = thumbs[i].querySelector(".lazy");
                lazy.src = lazy.getAttribute("data-src");
            }
        }
        var resultHeading = document.querySelector("#bird-search-results h2");
        resultHeading.setAttribute("data-count", resultCount);
    });
}

</script>



